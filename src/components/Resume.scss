@use "../styles/variables" as *;

/* Tunables to control spacing and widths */
:root {
  --connector: 24px; /* line from card to spine */
  --gap: 24px; /* space between fast and slow cards on a side */
  --fast-w: 20%; /* width of fast (inner) cards per side */
  --slow-w: 24%; /* width of slow (outer) cards per side */
}

.resume {
  width: 100%;
  padding: 4rem 0;
  background: $bgDark;
}

.resume__title {
  text-align: center;
  font-family: $fontTitle;
  color: $accent;
  letter-spacing: 1px;
  margin-bottom: 4rem;
  font-size: 2rem;
}

.resume__canvas {
  position: relative;
  width: 100%;
  min-height: 140vh;
  margin: 0;
  box-shadow: $concave; /* section is engraved */
  overflow: hidden;

  /* central spine with fade top/bottom */
  &::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 0;
    width: 4px;
    height: 100%;
    transform: translateX(-50%);
    background: linear-gradient(
      to bottom,
      transparent 0%,
      rgba(248, 178, 106, 0.5) 15%,
      rgba(248, 178, 106, 0.5) 85%,
      transparent 100%
    );
    border-radius: 2px;
    pointer-events: none;
  }

  /* soft edge fade so loops feel continuous */
  &::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom,
      rgba(26, 26, 26, 0.9) 0%,
      transparent 8%,
      transparent 92%,
      rgba(26, 26, 26, 0.9) 100%
    );
    pointer-events: none;
    mix-blend-mode: multiply;
  }
}

/* ===== Tracks (vertical infinite scroll) ===== */
@keyframes resume-scroll {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(-50%);
  } /* duplicated content => half height */
}

.resume__track {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;

  display: grid;
  grid-auto-rows: minmax(140px, auto);
  row-gap: 3.5rem;
  padding: 5rem 0;
  will-change: transform;
}

/* Slow outer track */
.resume__track--slow {
  animation: resume-scroll 30s linear infinite;
  z-index: 0; /* under fast */
}

/* Fast inner track (near spine) */
.resume__track--fast {
  animation: resume-scroll 30s linear infinite; /* faster */
  padding-top: calc(5rem + 2rem); /* offset so cards interleave */
  row-gap: 3rem;
  z-index: 10;
}

/* FAST = inner, subtle gray gradient, convex, opaque */
.resume__entry--fast {
  position: relative;
  z-index: 10; /* above slow */
  width: var(--fast-w);
  border-radius: 20px;
  box-shadow: $convex;
  padding: 1rem;

  /* subtle neutral gray sweep */
  background: linear-gradient(
      145deg,
      rgba(255, 255, 255, 0.06) 0%,
      /* light gray hint */ rgba(255, 255, 255, 0.03) 40%,
      rgba(0, 0, 0, 0.05) 70% /* slightly darker at end */
    ),
    $bgDark;

  outline: 1px solid rgba(255, 255, 255, 0.02); /* faint edge definition */
}

/* SLOW = outer, engraved, bigger, quote-block surface */
.resume__entry--slow {
  position: relative; /* create stacking context */
  z-index: 1; /* below fast cards */
  width: var(--slow-w);
  box-shadow: $innerConcave;

  /* subtle warm accent wash + soft diagonal sheen */
  background: linear-gradient(
      145deg,
      rgba($accent, 0.12) 0%,
      rgba($accent, 0.04) 38%,
      rgba(0, 0, 0, 0) 70%
    ),
    linear-gradient(
      to bottom right,
      rgba(255, 255, 255, 0.03),
      rgba(0, 0, 0, 0.1)
    );

  /* keep it matte like your quote block */
  backdrop-filter: none;
}

/* connector below everything */
.resume__entry--slow::after {
  z-index: -1;
}

// /* Pause both on hover/focus */
// .resume__canvas:hover .resume__track,
// .resume__canvas:focus-within .resume__track {
//   animation-play-state: paused;
// }

@media (prefers-reduced-motion: reduce) {
  .resume__track {
    animation: none;
  }
}

/* ===== Entries ===== */
.resume__entry {
  position: relative;
  border-radius: 20px;
  color: #ddd;
  padding: 1.25rem;

  /* connector to the central spine (default: fast length) */
  &::after {
    content: "";
    position: absolute;
    top: 50%;
    width: var(--connector);
    height: 2px;
    background: rgba(248, 178, 106, 0.35);
    transform: translateY(-50%);
  }
}

/* SLOW = outer, engraved, bigger (like QuoteBlock) */
.resume__entry--slow {
  width: var(--slow-w);
  box-shadow: $convex; /* engraved/concave surface */
  backdrop-filter: none;
}

/* FAST = inner, convex, close to spine, no gradient backgrounds */
.resume__entry--fast {
  width: var(--fast-w);
  box-shadow: $convex; /* raised/embossed */
  padding: 1rem; /* slightly tighter */
  //   background: $bgDark; /* flat fill to avoid gradient look */
  backdrop-filter: none;
}

/* ===== Connector math ===== */
/* Pixel vars set by JS (canvas width * fast %) so slow connectors reach spine */
.resume__entry--slow::after {
  width: calc(
    var(--connector-px, var(--connector)) + var(--gap-px, var(--gap)) +
      var(--fast-w-px, 0px)
  );
}

/* Base side offsets for fast cards (short connector) */
.resume__entry--left::after {
  right: calc(-1 * var(--connector));
}
.resume__entry--right::after {
  left: calc(-1 * var(--connector));
}

/* Slow side offsets — push start point outward by the extra length */
.resume__entry--slow.resume__entry--left::after {
  right: calc(
    -1 * (var(--connector-px, var(--connector)) + var(--gap-px, var(--gap)) +
          var(--fast-w-px, 0px))
  );
}
.resume__entry--slow.resume__entry--right::after {
  left: calc(
    -1 * (var(--connector-px, var(--connector)) + var(--gap-px, var(--gap)) +
          var(--fast-w-px, 0px))
  );
}

/* ===== Side alignment (positions) ===== */
/* ---------- LEFT ---------- */
.resume__entry--left {
  /* connector defined above */
}
/* Fast (inner) left — snug to spine */
.resume__entry--fast.resume__entry--left {
  margin-left: calc(50% - var(--fast-w) - var(--connector));
}
/* Slow (outer) left — further out, leaving a gap for fast */
.resume__entry--slow.resume__entry--left {
  margin-left: calc(
    50% - var(--fast-w) - var(--gap) - var(--slow-w) - var(--connector)
  );
}

/* ---------- RIGHT ---------- */
.resume__entry--right {
  /* connector defined above */
}
/* Fast (inner) right — snug to spine */
.resume__entry--fast.resume__entry--right {
  margin-left: calc(50% + var(--connector));
}
/* Slow (outer) right — further out, leaving a gap for fast */
.resume__entry--slow.resume__entry--right {
  margin-left: calc(50% + var(--fast-w) + var(--gap) + var(--connector));
}

/* ===== Content styling ===== */
.resume__entry-head {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 1rem;
  margin-bottom: 0.35rem;
}
.resume__entry-title {
  font-size: 1.05rem;
  letter-spacing: 0.5px;
}
.resume__entry-period {
  font-size: 0.85rem;
  color: $textMuted;
}
.resume__entry-blurb {
  font-size: 0.95rem;
  opacity: 0.9;
  line-height: 1.5;
}

/* ===== Responsive ===== */
@media (max-width: 1100px) {
  :root {
    --fast-w: 26%;
    --slow-w: 38%;
    --gap: 20px;
  }
}
@media (max-width: 900px) {
  :root {
    --fast-w: 30%;
    --slow-w: 34%;
    --gap: 16px;
  }
}
@media (max-width: 740px) {
  /* Collapse to single column centered on spine */
  .resume__entry,
  .resume__entry--fast,
  .resume__entry--slow {
    width: min(92%, 520px);
    margin-left: 50%;
    transform: translateX(-50%);
  }
  .resume__entry::after {
    display: none;
  } /* hide connectors on small screens */
}
